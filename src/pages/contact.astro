---
import Layout from "../layouts/Layout.astro";
import Image from "astro/components/Image.astro";
import axios from "axios";
---

<section class="contact-form">
  <div contact-container>
    <form action="https://submit-form.com/your-form-id">
      <input
        type="text"
        name="first-name"
        placeholder="first name"
        class="text-input"
      />
      <input
        type="text"
        name="last-name"
        placeholder="last name"
        class="text-input"
      />
      <input type="email" name="email" placeholder="email" class="text-input" />
      <input
        type="text"
        name="message"
        placeholder="message"
        class="text-input message-text"
      />
      <div class="checkbox-container">
        <input type="checkbox" name="kitchen" class="checkbox" />
        <input type="checkbox" name="closet" class="checkbox" />
        <input type="checkbox" name="bathroom" class="checkbox" />
        <input type="checkbox" name="kitchen" class="checkbox" />

        <label for="file-upload">Upload project images</label>
        <div class="box__input">
          <input
            class="box__file"
            type="file"
            name="files[]"
            accept="image/png, image/jpeg, image/webp, image/gif"
            id="file-upload"
            data-multiple-caption="{count} files selected"
            multiple
          />
          <label for="file"
            ><strong>Choose a file</strong><span class="box__dragndrop">
              or drag it here</span
            >
          </label>
          <button class="box__button" type="submit">Upload</button>
          <div class="box__uploading">Uploadingâ€¦</div>
          <div class="box__success">Done!</div>
          <div class="box__error">Error! <span></span>.</div>
        </div>
        <button type="submit">Send</button>
      </div>
    </form>

    <!-- <iframe src="...." frameborder="0" class="contact-iframe"> </iframe> -->
  </div>
</section>

<script type="module">
  import * as LR from "@uploadcare/blocks";
  LR.registerBlocks(LR);
</script>

<lr-config 
ctx-name="my-uploader" 
pubkey="e8567231b94b07c13e67" 
max-local-file-size-bytes="10000000"
img-only="true"
source-list="local, url, camera, instagram"
>
</lr-config>

<lr-file-uploader-regular
  ctx-name="my-uploader"
  css-src="https://cdn.jsdelivr.net/npm/@uploadcare/blocks@0.35.2/web/lr-file-uploader-regular.min.css"
></lr-file-uploader-regular>

<script>
  import axios from "axios";
  axios
    .post("https://submit-form.com/your-form-id", {
      first: "Fred",
      last: "Flintstone",
      message: "hello",
      email: {
        from: "",
        subject: "",
        template: {
          title: false,
          footer: false,
        },
      },
    })
    .then(function (response) {
      console.log(response);
    })
    .catch(function (error) {
      console.log(error);
    });

  let isAdvancedUpload = (function () {
    let div = document.createElement("div");
    return (
      "draggable" in div ||
      ("ondragstart" in div &&
        "ondrop" in div &&
        "FormData" in window &&
        "FileReader" in window)
    );
  })();

  let form = document.getElementsByClassName("box")[0]
    .firstChild as HTMLElement;
  form.classList.add("has-advanced-upload");

  if (isAdvancedUpload) {
    let form = document.querySelector("form");
    let droppedFiles = false;

    form.addEventListener("drag", handleDragEvents);
    form.addEventListener("drag", handleDragEvents);
    form.addEventListener("drag", handleDragEvents);
    form.addEventListener("drag", handleDragEvents);
    form.addEventListener("drag", handleDragEvents);

    function handleDragEvents(e) {
      e.preventDefault();
      e.stopPropagation();

      if (e.type === "dragover" || e.type === "dragenter") {
        form.classList.add("is-dragover");
      } else {
        form.classList.remove("is-dragover");
      }
    }
    function handleDrop(e) {
      droppedFiles = e.dataTransfer.files;
    }
  }
</script>

<style>
  .contact-form {
    display: flex;
    flex-direction: column;
    justify-self: center;
    align-items: center;
  }

  .contact-container {
    width: 80%;
    padding: 1rem;
    background-color: ececec;
    border-radius: 10px;
  }

  .checkbox-container {
    display: flex;
    flex-flow: row-wrap;
    width: 60%;
    align-items: center;
  }

  .message-text {
    height: 10rem;
  }

  .text-input {
    width: 60%;
    padding: 0.2rem;
    border-radius: 10px;
    margin-bottom: 1rem;
  }

  .box-input {
    height: 20rem;
    border: 1px dashed black;
  }

  .checkbox {
  }

  .box__dragndrop,
  .box__uploading,
  .box__success,
  .box__error {
    display: none;
  }

  .box.has-advanced-upload {
    background-color: white;
    outline: 2px dashed black;
    outline-offset: -10px;
  }

  .box.has-advanced-upload .box__dragndrop {
    display: inline;
  }

  .my-config {
    --darkmode: 0;
    --h-accent: 144;
    --s-accent: 67%;
    --l-accent: 57%;
  }
</style>
